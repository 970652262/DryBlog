# ä»£ç å—ä¼˜åŒ–è¯´æ˜æ–‡æ¡£

## ğŸ¨ æ”¹è¿›å†…å®¹

### 1. ä¿®å¤ä»£ç é«˜äº®é¢œè‰²é—®é¢˜ âœ…

**é—®é¢˜**: ä»£ç å—ä¸­çš„è¯­æ³•é«˜äº®é¢œè‰²ä¸¢å¤±

**è§£å†³æ–¹æ¡ˆ**:
- ä¿ç•™ `highlight.js` çš„åŸç”Ÿè¯­æ³•é«˜äº®ç±»
- ä¸ºæ·±è‰²æ¨¡å¼æ·»åŠ äº†å®Œæ•´çš„è¯­æ³•é«˜äº®é¢œè‰²å®šä¹‰
- ä½¿ç”¨ GitHub ä¸»é¢˜é…è‰²æ–¹æ¡ˆï¼ˆæµ…è‰²æ¨¡å¼ä½¿ç”¨ github.cssï¼Œæ·±è‰²æ¨¡å¼è‡ªå®šä¹‰ï¼‰

**é¢œè‰²æ–¹æ¡ˆ**ï¼ˆæ·±è‰²æ¨¡å¼ï¼‰:
- å…³é”®å­—ï¼š`#ff7b72` (çº¢è‰²)
- å‡½æ•°/ç±»åï¼š`#d2a8ff` (ç´«è‰²)
- å­—ç¬¦ä¸²ï¼š`#a5d6ff` (æµ…è“è‰²)
- æ•°å­—/å±æ€§ï¼š`#79c0ff` (è“è‰²)
- æ³¨é‡Šï¼š`#8b949e` (ç°è‰²)
- å†…ç½®å‡½æ•°ï¼š`#ffa657` (æ©™è‰²)
- æ ‡ç­¾åï¼š`#7ee787` (ç»¿è‰²)

### 2. è°ƒæ•´ä»£ç å—è¡Œé«˜ âœ…

**é—®é¢˜**: è¡Œé«˜è¿‡å¤§ï¼Œä»£ç æ˜¾å¾—ç¨€ç–

**æ”¹è¿›**:
- ä» `line-height: 1.75` è°ƒæ•´ä¸º `line-height: 1.45`
- å‡å° `min-height` ä¸º `1.45rem`
- ä»£ç æ›´ç´§å‡‘ï¼Œæ›´ç¬¦åˆç¼–ç¨‹ä¹ æƒ¯
- ä¿æŒè¶³å¤Ÿçš„å¯è¯»æ€§

**å¯¹æ¯”**:
```
ä¹‹å‰: line-height: 1.75 (è¾ƒæ¾æ•£)
ç°åœ¨: line-height: 1.45 (æ›´ç´§å‡‘)
```

### 3. æ·»åŠ å¤åˆ¶æŒ‰é’® âœ…

**åŠŸèƒ½**:
- å³ä¸Šè§’æ‚¬åœæ˜¾ç¤ºå¤åˆ¶æŒ‰é’®
- ç‚¹å‡»å¤åˆ¶çº¯ä»£ç ï¼ˆè‡ªåŠ¨å»é™¤è¡Œå·ï¼‰
- å¤åˆ¶æˆåŠŸåæ˜¾ç¤º"å·²å¤åˆ¶!"åé¦ˆ
- 2ç§’åæ¢å¤ä¸º"å¤åˆ¶"æ–‡æœ¬

**æ ·å¼ç‰¹æ€§**:
- é»˜è®¤éšè—ï¼ˆ`opacity: 0`ï¼‰
- é¼ æ ‡æ‚¬åœä»£ç å—æ—¶æ˜¾ç¤ºï¼ˆ`opacity: 1`ï¼‰
- æµ…è‰²/æ·±è‰²ä¸»é¢˜è‡ªé€‚åº”
- æ‚¬åœæ—¶è¾¹æ¡†å˜ä¸ºå“ç‰Œè‰²

**å®ç°ç»†èŠ‚**:
```typescript
// å¤åˆ¶åŠŸèƒ½å®ç°
navigator.clipboard.writeText(text).then(() => {
  target.textContent = 'å·²å¤åˆ¶!';
  setTimeout(() => {
    target.textContent = 'å¤åˆ¶';
  }, 2000);
});
```

---

## ğŸ“ æŠ€æœ¯ç»†èŠ‚

### CSS æ”¹åŠ¨

**æ–‡ä»¶**: `app/globals.css`

#### è¡Œé«˜è°ƒæ•´
```css
pre.code-with-lines code {
  line-height: 1.45; /* ä» 1.75 æ”¹ä¸º 1.45 */
}

pre.code-with-lines .code-line {
  min-height: 1.45rem; /* ä» 1.75rem æ”¹ä¸º 1.45rem */
  line-height: 1.45;
}
```

#### å¤åˆ¶æŒ‰é’®æ ·å¼
```css
pre.code-with-lines .copy-button {
  position: absolute;
  top: 0.5rem;
  right: 0.5rem;
  opacity: 0;
  transition: opacity 0.2s;
  z-index: 10;
}

pre.code-with-lines:hover .copy-button {
  opacity: 1;
}
```

#### æ·±è‰²æ¨¡å¼è¯­æ³•é«˜äº®
```css
/* å…³é”®å­— */
.dark .hljs-keyword {
  color: #ff7b72;
}

/* å­—ç¬¦ä¸² */
.dark .hljs-string {
  color: #a5d6ff;
}

/* æ³¨é‡Š */
.dark .hljs-comment {
  color: #8b949e;
}

/* ... æ›´å¤šé¢œè‰²å®šä¹‰ */
```

### ç»„ä»¶æ”¹åŠ¨

**æ–‡ä»¶**: `components/EnhancedMarkdown.tsx`

#### æ·»åŠ å¤åˆ¶æŒ‰é’®åˆ°ä»£ç å—
```typescript
code({ text, lang }: { text: string; lang?: string | null }) {
  const copyButton = '<button class="copy-button">å¤åˆ¶</button>';
  // ... æ¸²æŸ“é€»è¾‘
  return `<pre class="code-with-lines">${copyButton}<code>...</code></pre>`;
}
```

#### å¤åˆ¶äº‹ä»¶å¤„ç†
```typescript
useEffect(() => {
  const handleCopy = (e: MouseEvent) => {
    const target = e.target as HTMLElement;
    if (target.classList.contains('copy-button')) {
      // æå–ä»£ç å¹¶å¤åˆ¶åˆ°å‰ªè´´æ¿
      const text = extractCodeText(code);
      navigator.clipboard.writeText(text);
    }
  };

  document.addEventListener('click', handleCopy);
  return () => document.removeEventListener('click', handleCopy);
}, []);
```

#### DOMPurify é…ç½®æ›´æ–°
```typescript
const safe = dompurify.sanitize(raw, {
  ADD_TAGS: ['button'],   // å…è®¸ button æ ‡ç­¾
  ADD_ATTR: ['class']      // å…è®¸ class å±æ€§
});
```

---

## ğŸ¯ ä½¿ç”¨æ•ˆæœ

### æµ…è‰²æ¨¡å¼
- ç™½è‰²èƒŒæ™¯ (`#ffffff`)
- GitHub é£æ ¼è¯­æ³•é«˜äº®
- æ¸…æ™°çš„ä»£ç é¢œè‰²åŒºåˆ†
- æ‚¬åœæ˜¾ç¤ºå¤åˆ¶æŒ‰é’®

### æ·±è‰²æ¨¡å¼
- æ·±è‰²èƒŒæ™¯ (`#0d1117`)
- GitHub Dark é£æ ¼è¯­æ³•é«˜äº®
- é«˜å¯¹æ¯”åº¦é¢œè‰²æ–¹æ¡ˆ
- æ›´æŸ”å’Œçš„è¡Œå·å’Œè¾¹æ¡†

### äº¤äº’æ•ˆæœ
- ä»£ç è¡Œæ‚¬åœé«˜äº®ï¼ˆæ·¡ç°è‰²èƒŒæ™¯ï¼‰
- å¤åˆ¶æŒ‰é’®æ‚¬åœæ•ˆæœ
- å¤åˆ¶æˆåŠŸåé¦ˆ
- å¹³æ»‘çš„è¿‡æ¸¡åŠ¨ç”»

---

## ğŸ” ä»£ç ç¤ºä¾‹å¯¹æ¯”

### ä¼˜åŒ–å‰
- âŒ è¯­æ³•é«˜äº®é¢œè‰²ä¸¢å¤±
- âŒ è¡Œé«˜è¿‡å¤§ï¼ˆ1.75ï¼‰
- âŒ æ— å¤åˆ¶æŒ‰é’®
- âŒ æ·±è‰²æ¨¡å¼ä¸‹å¯¹æ¯”åº¦ä½

### ä¼˜åŒ–å
- âœ… å®Œæ•´çš„è¯­æ³•é«˜äº®
- âœ… ç´§å‡‘çš„è¡Œé«˜ï¼ˆ1.45ï¼‰
- âœ… ä¸€é”®å¤åˆ¶åŠŸèƒ½
- âœ… æ·±æµ…ä¸»é¢˜å®Œç¾æ”¯æŒ

---

## ğŸ“Š æ”¯æŒçš„è¯­è¨€

ä»£ç é«˜äº®æ”¯æŒæ‰€æœ‰ `highlight.js` æ”¯æŒçš„è¯­è¨€ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºï¼š

- JavaScript / TypeScript
- Python / Java / C++ / C#
- Go / Rust / Swift
- HTML / CSS / SCSS
- SQL / GraphQL
- Bash / Shell
- **Solidity** (æ™ºèƒ½åˆçº¦)
- JSON / YAML / TOML
- Markdown
- ç­‰ç­‰...

---

## ğŸš€ æ€§èƒ½ä¼˜åŒ–

1. **æ‡’åŠ è½½**: highlight.js åªåœ¨å®¢æˆ·ç«¯åŠ¨æ€åŠ è½½
2. **ç¼“å­˜**: è¯­æ³•é«˜äº®ç»“æœè¢«ç¼“å­˜
3. **DOMPurify**: å®‰å…¨æ¸…ç†HTMLï¼Œé˜²æ­¢XSS
4. **äº‹ä»¶å§”æ‰˜**: ä½¿ç”¨å•ä¸€äº‹ä»¶ç›‘å¬å™¨å¤„ç†æ‰€æœ‰å¤åˆ¶æŒ‰é’®

---

## ğŸ› å·²çŸ¥é—®é¢˜

æ— å·²çŸ¥é—®é¢˜

---

## ğŸ“ åç»­æ”¹è¿›å»ºè®®

1. **è¯­è¨€æ ‡ç­¾æ˜¾ç¤º**: åœ¨ä»£ç å—å·¦ä¸Šè§’æ˜¾ç¤ºè¯­è¨€åç§°
2. **è¡Œå·å¯é€‰**: æ·»åŠ å¼€å…³æ§åˆ¶æ˜¯å¦æ˜¾ç¤ºè¡Œå·
3. **ä¸»é¢˜åˆ‡æ¢**: æ”¯æŒå¤šç§ä»£ç é«˜äº®ä¸»é¢˜
4. **ä»£ç æŠ˜å **: é•¿ä»£ç å—æ”¯æŒæŠ˜å /å±•å¼€
5. **ä»£ç æœç´¢**: ä»£ç å—å†…æœç´¢åŠŸèƒ½

---

**æ›´æ–°æ—¶é—´**: 2025-12-09
**ç‰ˆæœ¬**: v1.1.1
