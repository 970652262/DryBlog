@tailwind base;
@tailwind components;
@tailwind utilities;

/* Highlight.js theme - 浅色模式使用 github */
@import "highlight.js/styles/github.css";

:root {
  --grid-size: 30px;
  --grid-line-light: rgba(240, 180, 90, 0.35); /* 浅色线条 */
  --grid-line-light-bold: rgba(240, 180, 90, 0.55);
  --grid-base-1: #fbe7c6;
  --grid-base-2: #fbe7c6;
  --grid-base-3: #fbe7c6;

  --grid-dark-1: #0d0f13;
  --grid-dark-2: #12161d;
  --grid-dark-3: #181d25;
  --grid-line-dark: rgba(255, 255, 255, 0.05);
  --grid-line-dark-bold: rgba(255, 255, 255, 0.08);
}

/* 杏黄色笔记本格子背景（浅色） */
body {
  @apply antialiased text-gray-900 dark:text-gray-100;
  background-attachment: fixed;
  /* 重新排序：最底部是主渐变，其上叠加格子线，最顶是高光点，确保格子可见 */
  background-image:
    /* 顶层柔光高光点 */ radial-gradient(
      circle at 20% 25%,
      rgba(255, 255, 255, 0.55),
      rgba(255, 255, 255, 0) 60%
    ),
    radial-gradient(
      circle at 78% 70%,
      rgba(255, 255, 255, 0.4),
      rgba(255, 255, 255, 0) 60%
    ),
    /* 竖向细格线 */
      repeating-linear-gradient(
        90deg,
        transparent 0 calc(var(--grid-size) - 1px),
        var(--grid-line-light) calc(var(--grid-size) - 1px) var(--grid-size)
      ),
    /* 横向细格线 */
      repeating-linear-gradient(
        0deg,
        transparent 0 calc(var(--grid-size) - 1px),
        var(--grid-line-light) calc(var(--grid-size) - 1px) var(--grid-size)
      ),
    /* 主渐变底色（放在最底部） */
      linear-gradient(
        135deg,
        var(--grid-base-1) 0%,
        var(--grid-base-2) 55%,
        var(--grid-base-3) 100%
      );
  /* 调整混合模式，避免格子线条被 multiply 淡化不可见 */
  background-blend-mode: screen, screen, normal, normal, normal, normal, normal;
  position: relative;
}

/* 高级黑渐变格子背景（深色模式） */
.dark body {
  /* 深色模式同样调整顺序 */
  background-image: radial-gradient(
      circle at 22% 28%,
      rgba(255, 255, 255, 0.08),
      rgba(255, 255, 255, 0) 60%
    ),
    radial-gradient(
      circle at 80% 72%,
      rgba(255, 255, 255, 0.06),
      rgba(255, 255, 255, 0) 60%
    ),
    repeating-linear-gradient(
      90deg,
      transparent 0 calc(var(--grid-size) - 1px),
      var(--grid-line-dark) calc(var(--grid-size) - 1px) var(--grid-size)
    ),
    repeating-linear-gradient(
      0deg,
      transparent 0 calc(var(--grid-size) - 1px),
      var(--grid-line-dark) calc(var(--grid-size) - 1px) var(--grid-size)
    ),
    linear-gradient(
      135deg,
      var(--grid-dark-1) 0%,
      var(--grid-dark-2) 55%,
      var(--grid-dark-3) 100%
    );
  /* 深色模式同样统一为 normal 以提升格子线条可见度 */
  background-blend-mode: screen, screen, normal, normal, normal, normal, normal;
}

/* 可选：减少动效时只保留底层纯色（访问性优化） */
@media (prefers-reduced-motion: reduce) {
  body {
    background-image: linear-gradient(
      135deg,
      var(--grid-base-2),
      var(--grid-base-3)
    );
  }
  .dark body {
    background-image: linear-gradient(
      135deg,
      var(--grid-dark-1),
      var(--grid-dark-3)
    );
  }
}

a {
  @apply text-brand-500 dark:text-brand-300;
}
input,
textarea {
  @apply w-full rounded border border-gray-300 px-3 py-2 text-sm focus:outline-none focus:ring focus:ring-brand-500/30;
}
button {
  @apply inline-flex items-center justify-center rounded bg-brand-500 px-4 py-2 text-white text-sm font-medium shadow-sm hover:bg-brand-500/90 disabled:opacity-50 disabled:cursor-not-allowed dark:shadow-none dark:bg-brand-500 dark:hover:bg-brand-500/90;
}
form {
  @apply flex flex-col gap-3;
}
h1,
h2,
label,
h3 {
  @apply font-semibold text-gray-800 dark:text-gray-100;
}
/* 代码块样式优化 */
pre {
  @apply overflow-x-auto rounded-lg p-4 text-sm shadow-lg relative;
  background: rgba(246, 248, 250, 0.6) !important;
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
  border: 1px solid #e1e4e8;
  font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
  line-height: 1.3;
  tab-size: 2;
}

.dark pre {
  background: rgba(13, 17, 23, 0.7) !important;
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
  border: 1px solid #30363d;
}

/* 改善代码高亮对比度 - 保留语法高亮颜色 */
pre code.hljs {
  @apply text-sm;
  background: transparent !important;
  font-family: inherit;
  display: block;
  overflow-x: auto;
  padding: 0;
}

/* 深色模式下的语法高亮颜色 */
.dark .hljs {
  color: #c9d1d9;
  background: transparent;
}

.dark .hljs-doctag,
.dark .hljs-keyword,
.dark .hljs-meta .hljs-keyword,
.dark .hljs-template-tag,
.dark .hljs-template-variable,
.dark .hljs-type,
.dark .hljs-variable.language_ {
  color: #ff7b72;
}

.dark .hljs-title,
.dark .hljs-title.class_,
.dark .hljs-title.class_.inherited__,
.dark .hljs-title.function_ {
  color: #d2a8ff;
}

.dark .hljs-attr,
.dark .hljs-attribute,
.dark .hljs-literal,
.dark .hljs-meta,
.dark .hljs-number,
.dark .hljs-operator,
.dark .hljs-variable,
.dark .hljs-selector-attr,
.dark .hljs-selector-class,
.dark .hljs-selector-id {
  color: #79c0ff;
}

.dark .hljs-regexp,
.dark .hljs-string,
.dark .hljs-meta .hljs-string {
  color: #a5d6ff;
}

.dark .hljs-built_in,
.dark .hljs-symbol {
  color: #ffa657;
}

.dark .hljs-comment,
.dark .hljs-code,
.dark .hljs-formula {
  color: #8b949e;
}

.dark .hljs-name,
.dark .hljs-quote,
.dark .hljs-selector-tag,
.dark .hljs-selector-pseudo {
  color: #7ee787;
}

.dark .hljs-subst {
  color: #c9d1d9;
}

.dark .hljs-section {
  color: #1f6feb;
  font-weight: bold;
}

.dark .hljs-bullet {
  color: #f2cc60;
}

.dark .hljs-emphasis {
  color: #c9d1d9;
  font-style: italic;
}

.dark .hljs-strong {
  color: #c9d1d9;
  font-weight: bold;
}

.dark .hljs-addition {
  color: #aff5b4;
  background-color: #033a16;
}

.dark .hljs-deletion {
  color: #ffdcd7;
  background-color: #67060c;
}

/* 代码行号样式优化 */
pre.code-with-lines {
  @apply pl-0 relative;
}

/* 复制按钮样式 */
pre.code-with-lines .copy-button {
  @apply absolute top-2 right-2 px-2 py-1 text-xs rounded opacity-0 transition-opacity;
  background: rgba(255, 255, 255, 0.9);
  border: 1px solid #d0d7de;
  color: #24292f;
  cursor: pointer;
  z-index: 10;
}

pre.code-with-lines:hover .copy-button {
  opacity: 1;
}

.dark pre.code-with-lines .copy-button {
  background: rgba(22, 27, 34, 0.9);
  border: 1px solid #30363d;
  color: #c9d1d9;
}

pre.code-with-lines .copy-button:hover {
  background: rgba(255, 255, 255, 1);
  border-color: #1f6feb;
}

.dark pre.code-with-lines .copy-button:hover {
  background: rgba(22, 27, 34, 1);
  border-color: #58a6ff;
}

pre.code-with-lines code {
  display: block;
  padding-left: 0;
  position: relative;
  font-size: 0.875rem;
  line-height: 1.3;
}

pre.code-with-lines .code-line {
  display: block;
  white-space: pre;
  position: relative;
  padding-left: 4em;
  padding-right: 1em;
  min-height: 1.3rem;
  line-height: 1.3;
}

pre.code-with-lines .code-line:hover {
  background: rgba(175, 184, 193, 0.08);
}

.dark pre.code-with-lines .code-line:hover {
  background: rgba(110, 118, 129, 0.08);
}

pre.code-with-lines .line-number {
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  display: flex;
  align-items: center;
  justify-content: flex-end;
  width: 3.5em;
  padding-right: 1em;
  user-select: none;
  opacity: 0.5;
  font-variant-numeric: tabular-nums;
  color: #57606a;
  font-size: 0.75rem;
  border-right: 1px solid #d0d7de;
}

.dark pre.code-with-lines .line-number {
  color: #8b949e;
  opacity: 0.6;
  border-right: 1px solid #30363d;
}

/* 代码块包装器样式 */
.code-block-wrapper {
  @apply relative mb-6 rounded-lg overflow-hidden;
  background: #f6f8fa;
  border: 1px solid #e1e4e8;
}

.dark .code-block-wrapper {
  background: #0d1117;
  border: 1px solid #30363d;
}

.code-block-wrapper pre {
  @apply border-0 rounded-none shadow-none my-0;
}

/* 代码块语言标签和复制按钮样式 */
.code-block-wrapper .code-header {
  @apply flex items-center justify-between px-4 py-2 border-b;
  background: #ffffff;
  border-bottom: 1px solid #e1e4e8;
}

.dark .code-block-wrapper .code-header {
  background: #161b22;
  border-bottom: 1px solid #30363d;
}

.code-block-wrapper .language-label {
  @apply text-xs font-medium px-2 py-1 rounded;
  background: #f6f8fa;
  color: #57606a;
  border: 1px solid #d0d7de;
}

.dark .code-block-wrapper .language-label {
  background: #0d1117;
  color: #8b949e;
  border: 1px solid #30363d;
}

/* 内联代码样式 */
code:not(pre code) {
  @apply px-1.5 py-0.5 rounded text-sm;
  background: #f6f8fa;
  color: #cf222e;
  border: 1px solid #d0d7de;
  font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
}

.dark code:not(pre code) {
  background: #161b22;
  color: #ff7b72;
  border: 1px solid #30363d;
}

/* Card / surface helper */
.surface {
  @apply rounded border border-gray-200 bg-white/80 backdrop-blur shadow-sm dark:border-gray-700 dark:bg-gray-800/60 dark:shadow-lg;
}

/* Glass & gradient helpers */
.glass {
  @apply bg-white/60 dark:bg-neutral-800/40 backdrop-blur-xs border border-white/40 dark:border-neutral-700/40 shadow-glass rounded-xl relative overflow-hidden;
}
.glass::before {
  content: "";
  position: absolute;
  inset: 0;
  pointer-events: none;
  background: radial-gradient(
      circle at 20% 20%,
      rgba(255, 255, 255, 0.5),
      transparent 60%
    ),
    radial-gradient(
      circle at 80% 70%,
      rgba(255, 255, 255, 0.3),
      transparent 55%
    );
  mix-blend-mode: overlay;
}

.gradient-border {
  position: relative;
}
.gradient-border::before {
  content: "";
  position: absolute;
  inset: 0;
  padding: 1px;
  border-radius: inherit;
  background: linear-gradient(
    135deg,
    #0c61e2,
    #8ac3ff 40%,
    #3d99f5 70%,
    #0849b4
  );
  -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
  -webkit-mask-composite: xor;
  mask-composite: exclude;
}

/* Noise layer */
.noise-layer {
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: -1;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='60' height='60' viewBox='0 0 60 60'%3E%3Cfilter id='n' x='0' y='0'%3E%3CfeTurbulence baseFrequency='0.6' numOctaves='3' stitchTiles='stitch'/%3E%3C/fi lter%3E%3Crect width='60' height='60' filter='url(%23n)' opacity='0.08'/%3E%3C/svg%3E");
  mix-blend-mode: overlay;
}

/* Button variants */
.btn {
  @apply inline-flex items-center justify-center gap-2 rounded-md px-4 py-2 text-sm font-medium transition-colors focus:outline-none focus-visible:ring focus-visible:ring-brand-500/40 disabled:opacity-50 disabled:cursor-not-allowed select-none;
}
.btn-primary {
  @apply bg-brand-600 text-white hover:bg-brand-500 active:bg-brand-600/90 shadow-sm;
}
.btn-secondary {
  @apply bg-neutral-200 text-neutral-800 hover:bg-neutral-300 dark:bg-neutral-700 dark:text-neutral-100 dark:hover:bg-neutral-600;
}
.btn-ghost {
  @apply bg-transparent text-neutral-700 hover:bg-neutral-200/60 dark:text-neutral-200 dark:hover:bg-neutral-700/50;
}
.btn-outline {
  @apply border border-neutral-300 text-neutral-700 hover:bg-white dark:border-neutral-600 dark:text-neutral-100 dark:hover:bg-neutral-700;
}

/* Nav link animation */
.nav-link {
  @apply relative font-medium text-neutral-700 dark:text-neutral-200 px-2 py-1 rounded-md transition-colors;
}
.nav-link::after {
  content: "";
  position: absolute;
  left: 8px;
  right: 8px;
  bottom: 0;
  height: 2px;
  border-radius: 1px;
  background: linear-gradient(90deg, #0c61e2, #8ac3ff);
  transform: scaleX(0);
  transform-origin: left;
  transition: transform 0.35s ease;
}
.nav-link:hover::after,
.nav-link[aria-current="page"]::after {
  transform: scaleX(1);
}

/* Utility for subtle fade-in */
.fade-in {
  animation: fadeIn 0.4s ease-out;
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Prose dark adjustments */
.prose {
  @apply dark:prose-invert max-w-none;
}

.prose h1, .prose h2, .prose h3, .prose h4 {
  @apply font-semibold text-gray-900 dark:text-gray-100;
}

.prose p {
  @apply text-gray-700 dark:text-gray-300 leading-relaxed;
}

.prose a {
  @apply text-brand-500 dark:text-brand-400 hover:underline font-medium;
}

.prose blockquote {
  @apply border-l-4 border-brand-500 bg-brand-50 dark:bg-brand-900/20 italic;
}

.prose ul, .prose ol {
  @apply text-gray-700 dark:text-gray-300;
}

.prose table {
  @apply border-collapse w-full;
}

.prose th {
  @apply bg-gray-100 dark:bg-gray-800 font-semibold text-left px-4 py-2;
}

.prose td {
  @apply border border-gray-300 dark:border-gray-700 px-4 py-2;
}

/* 改进的滚动条样式 */
::-webkit-scrollbar {
  width: 10px;
  height: 10px;
}

::-webkit-scrollbar-track {
  @apply bg-gray-100 dark:bg-gray-900;
}

::-webkit-scrollbar-thumb {
  @apply bg-gray-400 dark:bg-gray-600 rounded-full;
}

::-webkit-scrollbar-thumb:hover {
  @apply bg-gray-500 dark:bg-gray-500;
}

/* 平滑滚动 */
html {
  scroll-behavior: smooth;
}

/* 选中文本样式 */
::selection {
  @apply bg-brand-500 text-white;
}

::-moz-selection {
  @apply bg-brand-500 text-white;
}

/* 焦点样式优化 */
button:focus-visible,
a:focus-visible,
input:focus-visible,
textarea:focus-visible {
  @apply outline-none ring-2 ring-brand-500 ring-offset-2 dark:ring-offset-gray-900;
}

/* 加载动画 */
@keyframes spin {
  to {
    transform: rotate(360deg);
  }
}

.animate-spin {
  animation: spin 1s linear infinite;
}

/* 脉冲动画 */
@keyframes pulse {
  0%, 100% {
    opacity: 1;
  }
  50% {
    opacity: 0.5;
  }
}

.animate-pulse {
  animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
}
